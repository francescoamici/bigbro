import{r as m}from"./index-R1Z8Tk4t.js";import{u as p,w as L,p as I,x as M,y as D,z as F,e as N,A as R,B as C,C as X,D as Y,E as $,F as G,G as V,I as E,q as y}from"./star-XL_efDnF.js";function z(e,t){let r;const s=()=>{const{currentTime:n}=t,c=(n===null?0:n.value)/100;r!==c&&e(c),r=c};return p.preUpdate(s,!0),()=>L(s)}const K=50,H=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),U=()=>({time:0,x:H(),y:H()}),j={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function T(e,t,r,s){const n=r[t],{length:l,position:c}=j[t],i=n.current,f=r.time;n.current=e[`scroll${c}`],n.scrollLength=e[`scroll${l}`]-e[`client${l}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=I(0,n.scrollLength,n.current);const o=s-f;n.velocity=o>K?0:M(n.current-i,o)}function q(e,t,r){T(e,"x",t,r),T(e,"y",t,r),t.time=r}function J(e,t){const r={x:0,y:0};let s=e;for(;s&&s!==t;)if(D(s))r.x+=s.offsetLeft,r.y+=s.offsetTop,s=s.offsetParent;else if(s.tagName==="svg"){const n=s.getBoundingClientRect();s=s.parentElement;const l=s.getBoundingClientRect();r.x+=n.left-l.left,r.y+=n.top-l.top}else if(s instanceof SVGGraphicsElement){const{x:n,y:l}=s.getBBox();r.x+=n,r.y+=l;let c=null,i=s.parentNode;for(;!c;)i.tagName==="svg"&&(c=i),i=s.parentNode;s=c}else break;return r}const W={start:0,center:.5,end:1};function O(e,t,r=0){let s=0;if(e in W&&(e=W[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?s=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?s=n/100*document.documentElement.clientWidth:e.endsWith("vh")?s=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(s=t*e),r+s}const _=[0,0];function Q(e,t,r,s){let n=Array.isArray(e)?e:_,l=0,c=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,W[e]?e:"0"]),l=O(n[0],r,s),c=O(n[1],t),l-c}const Z={All:[[0,0],[1,1]]},ee={x:0,y:0};function te(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function se(e,t,r){const{offset:s=Z.All}=r,{target:n=e,axis:l="y"}=r,c=l==="y"?"height":"width",i=n!==e?J(n,e):ee,f=n===e?{width:e.scrollWidth,height:e.scrollHeight}:te(n),o={width:e.clientWidth,height:e.clientHeight};t[l].offset.length=0;let u=!t[l].interpolate;const g=s.length;for(let a=0;a<g;a++){const d=Q(s[a],o[c],f[c],i[l]);!u&&d!==t[l].interpolatorOffsets[a]&&(u=!0),t[l].offset[a]=d}u&&(t[l].interpolate=F(t[l].offset,N(s),{clamp:!1}),t[l].interpolatorOffsets=[...t[l].offset]),t[l].progress=R(0,1,t[l].interpolate(t[l].current))}function re(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let s=t;for(;s&&s!==e;)r.x.targetOffset+=s.offsetLeft,r.y.targetOffset+=s.offsetTop,s=s.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function ne(e,t,r,s={}){return{measure:n=>{re(e,s.target,r),q(e,r,n),(s.offset||s.target)&&se(e,r,s)},notify:()=>t(r)}}const h=new WeakMap,S=new WeakMap,x=new WeakMap,P=new WeakMap,v=new WeakMap,k=e=>e===document.scrollingElement?window:e;function b(e,{container:t=document.scrollingElement,trackContentSize:r=!1,...s}={}){if(!t)return C;let n=x.get(t);n||(n=new Set,x.set(t,n));const l=U(),c=ne(t,e,l,s);if(n.add(c),!h.has(t)){const f=()=>{for(const a of n)a.measure(Y.timestamp);p.preUpdate(o)},o=()=>{for(const a of n)a.notify()},u=()=>p.read(f);h.set(t,u);const g=k(t);window.addEventListener("resize",u,{passive:!0}),t!==document.documentElement&&S.set(t,X(t,u)),g.addEventListener("scroll",u,{passive:!0}),u()}if(r&&!v.has(t)){const f=h.get(t),o={width:t.scrollWidth,height:t.scrollHeight};P.set(t,o);const u=()=>{const a=t.scrollWidth,d=t.scrollHeight;(o.width!==a||o.height!==d)&&(f(),o.width=a,o.height=d)},g=p.read(u,!0);v.set(t,g)}const i=h.get(t);return p.read(i,!1,!0),()=>{L(i);const f=x.get(t);if(!f||(f.delete(c),f.size))return;const o=h.get(t);h.delete(t),o&&(k(t).removeEventListener("scroll",o),S.get(t)?.(),window.removeEventListener("resize",o));const u=v.get(t);u&&(L(u),v.delete(t)),P.delete(t)}}const B=new Map;function le(e){const t={value:0},r=b(s=>{t.value=s[e.axis].progress*100},e);return{currentTime:t,cancel:r}}function A({source:e,container:t,...r}){const{axis:s}=r;e&&(t=e);const n=B.get(t)??new Map;B.set(t,n);const l=r.target??"self",c=n.get(l)??{},i=s+(r.offset??[]).join(",");return c[i]||(c[i]=!r.target&&$()?new ScrollTimeline({source:t,axis:s}):le({container:t,...r})),c[i]}function ce(e,t){const r=A(t);return e.attachTimeline({timeline:t.target?void 0:r,observe:s=>(s.pause(),z(n=>{s.time=s.iterationDuration*n},r))})}function oe(e){return e.length===2}function ie(e,t){return oe(e)?b(r=>{e(r[t.axis].progress,r)},t):z(e,A(t))}function fe(e,{axis:t="y",container:r=document.scrollingElement,...s}={}){if(!r)return C;const n={axis:t,container:r,...s};return typeof e=="function"?ie(e,n):ce(e,n)}const ue=()=>({scrollX:y(0),scrollY:y(0),scrollXProgress:y(0),scrollYProgress:y(0)}),w=e=>e?!e.current:!1;function ge({container:e,target:t,...r}={}){const s=G(ue),n=m.useRef(null),l=m.useRef(!1),c=m.useCallback(()=>(n.current=fe((i,{x:f,y:o})=>{s.scrollX.set(f.current),s.scrollXProgress.set(f.progress),s.scrollY.set(o.current),s.scrollYProgress.set(o.progress)},{...r,container:e?.current||void 0,target:t?.current||void 0}),()=>{n.current?.()}),[e,t,JSON.stringify(r.offset)]);return V(()=>{if(l.current=!1,w(e)||w(t)){l.current=!0;return}else return c()},[c]),m.useEffect(()=>{if(l.current)return E(!w(e)),E(!w(t)),c()},[c]),s}export{ge as u};
